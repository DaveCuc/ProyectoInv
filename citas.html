<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SGI - Interfaz Alumno</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        /* Barra superior azul cielo */
        .top-bar {
            background-color: #87CEEB;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* Logo del sistema */
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-img {
            width: 50px;
            height: 50px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #87CEEB;
        }
        
        .system-name {
            color: white;
        }
        
        .system-name h1 {
            font-size: 20px;
            margin-bottom: 3px;
        }
        
        /* Secci√≥n usuario */
        .user-section {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }
        
        .notification {
            position: relative;
            cursor: pointer;
            font-size: 20px;
            color: white;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: red;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            width: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 15px;
            display: none;
            z-index: 100;
        }
        
        .notification:hover .notification-dropdown {
            display: block;
        }
        
        .notification-item {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .no-notifications {
            color: #888;
            font-style: italic;
        }
        
        .user-pic {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #87CEEB;
            font-weight: bold;
        }
        
        .user-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            width: 200px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 15px;
            display: none;
            z-index: 100;
        }
        
        .user-pic:hover .user-dropdown {
            display: block;
        }
        
        .user-dropdown p {
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .user-dropdown button {
            display: block;
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            background: none;
            border: none;
            text-align: left;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .user-dropdown button:hover {
            background: #f0f0f0;
        }
        
        /* Contenido principal */
        .main-content {
            max-width: 600px;
            margin: 50px auto;
            text-align: center;
        }
        
        .welcome-title {
            font-size: 36px;
            color: #333;
            margin-bottom: 20px;
        }
        
        .student-info {
            margin-bottom: 40px;
        }
        
        .student-id {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .student-name {
            font-size: 24px;
            color: #333;
            font-weight: 500;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .action-button {
            padding: 12px 30px;
            background: #87CEEB;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            min-width: 180px;
        }
        
        .action-button:hover {
            background: #6cb8e0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* Estilos para el formulario de citas */
        #cita-form {
            max-width: 800px;
            margin: 30px auto;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid #c4dafa;
            display: none; /* Oculto inicialmente */
        }

        #cita-form .form-section {
            margin-bottom: 25px;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }

        #cita-form h2 {
            color: #4d82bc;
            margin-bottom: 20px;
            font-size: 24px;
        }

        #cita-form h3 {
            color: #4d82bc;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .asunto-container {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .asunto-input {
            padding: 12px 25px;
            border: 2px solid #84b6f4;
            border-radius: 30px;
            width: 350px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }

        .asunto-input:focus {
            border-color: #4d82bc;
            box-shadow: 0 0 0 3px rgba(77, 130, 188, 0.2);
        }

        .option-button {
            padding: 10px 25px;
            margin: 8px;
            border: 2px solid #84b6f4;
            border-radius: 25px;
            background: white;
            color: #4d82bc;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            font-size: 15px;
        }

        .option-button:hover:not(.active) {
            background: #f5d7ef;
        }

        .option-button.active {
            background: #4d82bc;
            color: white;
            border-color: #4d82bc;
        }

        .calendar-container {
            margin: 20px auto;
            max-width: 500px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #c4dafa;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .month-selector {
            font-size: 18px;
            font-weight: bold;
            color: #4d82bc;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day-header {
            font-weight: bold;
            padding: 10px 5px;
            text-align: center;
            color: #4d82bc;
            font-size: 14px;
        }

        .calendar-day {
            padding: 12px 5px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            background: #f8fafc;
        }

        .calendar-day:not(.disabled-day):not(.past-day) {
            background-color: #4d82bc;
            color: white;
        }

        .calendar-day.disabled-day, .calendar-day.past-day {
            background-color: #cccccc;
            color: #666666;
            cursor: not-allowed;
        }

        .calendar-day.has-appointments {
            background-color: #e74c3c;
            color: white;
        }

        .calendar-day.fully-booked {
            background-color: #e74c3c;
            color: white;
            cursor: not-allowed;
        }

        .calendar-day.selected {
            background-color: #2ecc71;
            color: white;
            box-shadow: 0 0 0 2px #27ae60;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .time-slot {
            padding: 12px;
            border: 1px solid #c4dafa;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            font-weight: 500;
        }

        .time-slot:not(.booked) {
            background-color: #4d82bc;
            color: white;
        }

        .time-slot.booked {
            background-color: #e74c3c;
            color: white;
            cursor: not-allowed;
        }

        .time-slot.selected {
            background-color: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        #cita-info {
            margin-top: 15px;
            padding: 15px;
            background: #f5d7ef;
            border-radius: 8px;
            color: #555;
        }

        #cita-info strong {
            color: #4d82bc;
        }

        /* Clases utilitarias */
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Barra superior -->
    <div class="top-bar">
        <div class="logo-section">
            <div class="logo-img">SGI</div>
            <div class="system-name">
                <h1>SGI Interfaz Alumno</h1>
            </div>
        </div>
        
        <div class="user-section">
            <div class="notification">
                üîî
                <div class="notification-badge">0</div>
                <div class="notification-dropdown">
                    <div class="notification-item no-notifications">
                        No tienes notificaciones pendientes
                    </div>
                </div>
            </div>
            
            <div class="user-pic">
                <span>NA</span>
                <div class="user-dropdown">
                    <p>NOMBRE ALUMNO</p>
                    <button>Actualizar Informaci√≥n</button>
                    <button>Cambiar Contrase√±a</button>
                    <button>Cerrar Sesi√≥n</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Contenido principal - Bienvenida -->
    <div id="welcome-content" class="main-content">
        <h1 class="welcome-title">BIENVENIDO</h1>
        
        <div class="student-info">
            <div class="student-id">Num Control: 12345678</div>
            <div class="student-name">Nombre Alumno</div>
        </div>
        
        <div class="action-buttons">
            <button class="action-button" id="btn-agendar">Agendar Cita</button>
            <button class="action-button" id="btn-consultar">Consultar Cita</button>
        </div>
    </div>

    <!-- Formulario de cita (oculto inicialmente) -->
    <div id="cita-form">
        <h2>Agendar Cita</h2>

        <div class="form-section">
            <div class="asunto-container">
                <h3>Asunto:</h3>
                <input type="text" class="asunto-input" placeholder="Escribe el asunto de la cita" id="asunto">
            </div>
        </div>

        <div class="form-section">
            <h3>Selecciona fecha</h3>
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="option-button" id="prev-month">‚óÄ</button>
                    <div class="month-selector" id="current-month">Mes A√±o</div>
                    <button class="option-button" id="next-month">‚ñ∂</button>
                </div>
                <div class="calendar-grid" id="calendar-days-header">
                    <div class="calendar-day-header">Lun</div>
                    <div class="calendar-day-header">Mar</div>
                    <div class="calendar-day-header">Mi√©</div>
                    <div class="calendar-day-header">Jue</div>
                    <div class="calendar-day-header">Vie</div>
                    <div class="calendar-day-header">S√°b</div>
                    <div class="calendar-day-header">Dom</div>
                </div>
                <div class="calendar-grid" id="calendar-days"></div>
            </div>
        </div>

        <div class="form-section">
            <h3>Turno</h3>
            <button class="option-button" onclick="selectTurno(this, 'Matutino')">Matutino</button>
            <button class="option-button" onclick="selectTurno(this, 'Vespertino')">Vespertino</button>
        </div>

        <div class="form-section" id="time-slots-section" style="display: none;">
            <h3>Horarios disponibles</h3>
            <div class="time-slots" id="time-slots"></div>
        </div>

        <div class="form-section">
            <h3>Primera vez con el psic√≥logo</h3>
            <button class="option-button" onclick="toggleSelection(this)">S√≠</button>
            <button class="option-button" onclick="toggleSelection(this)">No</button>
        </div>

        <div class="form-section">
            <h3>Atiende:</h3>
            <p>Nombre Psicologo</p>
            <p>Cita con NOMBRE PSICOLOGO</p>
            <p id="cita-info">Seleccione fecha y horario</p>
        </div>

        <div class="action-buttons">
            <button class="action-button" id="btn-atras">Atr√°s</button>
            <button class="action-button" id="btn-realizar" disabled>Realizar Cita</button>
        </div>
    </div>

    <script>
        // Variables globales para navegaci√≥n
        document.getElementById('btn-agendar').addEventListener('click', function() {
            document.getElementById('welcome-content').style.display = 'none';
            document.getElementById('cita-form').style.display = 'block';
        });

        document.getElementById('btn-atras').addEventListener('click', function() {
            document.getElementById('cita-form').style.display = 'none';
            document.getElementById('welcome-content').style.display = 'block';
        });

        // Variables globales para citas
        let currentDate = new Date();
        let selectedDate = null;
        let selectedTurno = null;
        let selectedTime = null;

        // Simulamos una "base de datos" de citas agendadas
        let bookedAppointments = JSON.parse(localStorage.getItem('bookedAppointments')) || {
            '2023-11-15': ['09:00', '10:30', '11:00', '12:00'], // D√≠a completamente ocupado (matutino)
            '2023-11-16': ['11:00', '16:00'],
            '2023-11-20': ['09:30', '15:00'],
            '2023-11-25': ['14:00', '15:00', '16:00', '17:00', '18:00'] // D√≠a completamente ocupado (vespertino)
        };

        // Inicializar calendario
        document.addEventListener('DOMContentLoaded', function () {
            renderCalendar();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('prev-month').addEventListener('click', function () {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });

            document.getElementById('next-month').addEventListener('click', function () {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });

            document.getElementById('btn-realizar').addEventListener('click', function () {
                realizarCita();
            });
        }

        function renderCalendar() {
            const calendarDays = document.getElementById('calendar-days');
            calendarDays.innerHTML = '';

            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
                "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];

            document.getElementById('current-month').textContent =
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;

            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

            // D√≠as del mes anterior
            const prevMonthDays = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1;

            // D√≠as del mes actual
            const daysInMonth = lastDay.getDate();

            // D√≠as del siguiente mes
            const nextMonthDays = 7 - (lastDay.getDay() === 0 ? 7 : lastDay.getDay());

            const totalDays = prevMonthDays + daysInMonth + nextMonthDays;

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            for (let i = 0; i < totalDays; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';

                if (i < prevMonthDays) {
                    // D√≠as del mes anterior (gris)
                    const prevDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 0);
                    const day = prevDate.getDate() - (prevMonthDays - i - 1);
                    dayElement.textContent = day;
                    dayElement.classList.add('disabled-day');
                } else if (i < prevMonthDays + daysInMonth) {
                    // D√≠as del mes actual
                    const day = i - prevMonthDays + 1;
                    dayElement.textContent = day;

                    const currentDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);

                    // Marcar d√≠as pasados (gris)
                    if (currentDay < today) {
                        dayElement.classList.add('past-day');
                    }

                    // Marcar d√≠as con citas ocupadas
                    const dateStr = formatDate(currentDay);
                    if (bookedAppointments[dateStr]) {
                        // Verificar si todos los horarios matutinos est√°n ocupados
                        const allMorningBooked = ['09:00', '10:00', '11:00', '12:00'].every(time => 
                            bookedAppointments[dateStr].includes(time));
                        
                        // Verificar si todos los horarios vespertinos est√°n ocupados
                        const allAfternoonBooked = ['14:00', '15:00', '16:00', '17:00', '18:00'].every(time => 
                            bookedAppointments[dateStr].includes(time));
                        
                        // Si ambos turnos est√°n completamente ocupados, marcar el d√≠a como completamente ocupado
                        if (allMorningBooked && allAfternoonBooked) {
                            dayElement.classList.add('fully-booked');
                        } else {
                            dayElement.classList.add('has-appointments');
                        }
                    }

                    // Evento click para seleccionar d√≠a
                    dayElement.addEventListener('click', function () {
                        if (!this.classList.contains('past-day') && 
                            !this.classList.contains('disabled-day') &&
                            !this.classList.contains('fully-booked')) {

                            // Quitar selecci√≥n anterior
                            document.querySelectorAll('.calendar-day.selected').forEach(el => {
                                el.classList.remove('selected');
                            });

                            // Seleccionar nuevo d√≠a
                            this.classList.add('selected');
                            selectedDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);

                            // Mostrar turnos si ya estaba seleccionado
                            if (selectedTurno) {
                                showTimeSlots();
                            }

                            updateCitaInfo();
                        }
                    });
                } else {
                    // D√≠as del siguiente mes (gris)
                    const day = i - (prevMonthDays + daysInMonth) + 1;
                    dayElement.textContent = day;
                    dayElement.classList.add('disabled-day');
                }

                calendarDays.appendChild(dayElement);
            }
        }

        function selectTurno(button, turno) {
            // Remover activo de todos los botones del mismo grupo
            const parent = button.parentElement;
            const buttons = parent.querySelectorAll('.option-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Activar el bot√≥n clickeado
            button.classList.add('active');
            selectedTurno = turno;

            // Mostrar horarios si ya hay fecha seleccionada
            if (selectedDate) {
                showTimeSlots();
            }

            updateCitaInfo();
        }

        function showTimeSlots() {
            const timeSlotsSection = document.getElementById('time-slots-section');
            const timeSlotsContainer = document.getElementById('time-slots');
            timeSlotsContainer.innerHTML = '';

            // Generar horarios seg√∫n el turno seleccionado (sin las 8:00 AM)
            const slots = selectedTurno === 'Matutino' ?
                ['09:00', '10:00', '11:00', '12:00'] :
                ['14:00', '15:00', '16:00', '17:00', '18:00'];

            const dateStr = formatDate(selectedDate);
            const bookedTimes = bookedAppointments[dateStr] || [];

            // Verificar si todos los horarios de este turno est√°n ocupados
            const allSlotsBooked = slots.every(slot => bookedTimes.includes(slot));
            
            if (allSlotsBooked) {
                timeSlotsContainer.innerHTML = '<p style="grid-column: 1 / -1; color: #e74c3c;">Todos los horarios para este turno est√°n ocupados</p>';
            } else {
                slots.forEach(slot => {
                    const slotElement = document.createElement('div');
                    slotElement.className = 'time-slot';
                    slotElement.textContent = slot;

                    // Verificar si el horario est√° ocupado (rojo)
                    if (bookedTimes.includes(slot)) {
                        slotElement.classList.add('booked');
                    } else {
                        slotElement.addEventListener('click', function () {
                            // Quitar selecci√≥n anterior
                            document.querySelectorAll('.time-slot.selected').forEach(el => {
                                el.classList.remove('selected');
                            });

                            // Seleccionar nuevo horario
                            this.classList.add('selected');
                            selectedTime = slot;
                            updateCitaInfo();
                        });
                    }

                    timeSlotsContainer.appendChild(slotElement);
                });
            }

            timeSlotsSection.style.display = 'block';
        }

        function toggleSelection(button) {
            // Remover activo de todos los botones del mismo grupo
            const parent = button.parentElement;
            const buttons = parent.querySelectorAll('.option-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Activar el bot√≥n clickeado
            button.classList.add('active');
        }

        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function updateCitaInfo() {
            const citaInfo = document.getElementById('cita-info');
            const btnRealizar = document.getElementById('btn-realizar');

            if (selectedDate && selectedTurno && selectedTime) {
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const fechaStr = selectedDate.toLocaleDateString('es-ES', options);

                citaInfo.innerHTML = `Cita agendada para el <strong>${fechaStr}</strong><br>
                                        en el horario de <strong>${selectedTime}</strong>`;

                btnRealizar.disabled = false;
            } else {
                citaInfo.textContent = 'Seleccione fecha y horario';
                btnRealizar.disabled = true;
            }
        }

        function realizarCita() {
            if (selectedDate && selectedTurno && selectedTime) {
                const dateStr = formatDate(selectedDate);

                // Guardar en nuestra "base de datos" local
                if (!bookedAppointments[dateStr]) {
                    bookedAppointments[dateStr] = [];
                }

                // Verificar si el horario ya est√° ocupado
                if (!bookedAppointments[dateStr].includes(selectedTime)) {
                    bookedAppointments[dateStr].push(selectedTime);

                    // Actualizar localStorage
                    localStorage.setItem('bookedAppointments', JSON.stringify(bookedAppointments));

                    // Mostrar mensaje de √©xito
                    alert(`Cita agendada con √©xito para el ${dateStr} a las ${selectedTime}`);

                    // Resetear selecciones
                    selectedDate = null;
                    selectedTurno = null;
                    selectedTime = null;

                    // Actualizar UI
                    document.querySelectorAll('.selected').forEach(el => {
                        el.classList.remove('selected');
                    });
                    document.getElementById('time-slots-section').style.display = 'none';
                    updateCitaInfo();
                    renderCalendar();

                    // Volver a la pantalla principal
                    document.getElementById('cita-form').style.display = 'none';
                    document.getElementById('welcome-content').style.display = 'block';
                } else {
                    alert('Este horario ya ha sido ocupado. Por favor seleccione otro.');
                }
            }
        }

        // Control de men√∫s desplegables
        document.querySelector('.user-pic').addEventListener('click', function(e) {
            e.stopPropagation();
            document.querySelector('.user-dropdown').style.display = 
                document.querySelector('.user-dropdown').style.display === 'block' ? 'none' : 'block';
        });
        
        document.querySelector('.notification').addEventListener('click', function(e) {
            e.stopPropagation();
            document.querySelector('.notification-dropdown').style.display = 
                document.querySelector('.notification-dropdown').style.display === 'block' ? 'none' : 'block';
        });
        
        // Cerrar dropdowns al hacer click fuera
        document.addEventListener('click', function() {
            document.querySelector('.user-dropdown').style.display = 'none';
            document.querySelector('.notification-dropdown').style.display = 'none';
        });
    </script>
</body>
</html>